(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{1034:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"_1-2-源码编译安装-要科学的安装规划路径"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-源码编译安装-要科学的安装规划路径"}},[s._v("#")]),s._v(" 1.2 源码编译安装（要科学的安装规划路径）")]),s._v(" "),t("p",[s._v("下载源码地址：")]),s._v(" "),t("p",[s._v("https://www.postgresql.org/ftp/source/v10.20/")]),s._v(" "),t("h4",{attrs:{id:"_1-2-1将包放在soft目录下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1将包放在soft目录下"}},[s._v("#")]),s._v(" 1.2.1将包放在soft目录下")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost soft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/root/soft\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost soft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\npostgresql-10.20.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_1-2-2准备编译环境和数据目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2准备编译环境和数据目录"}},[s._v("#")]),s._v(" 1.2.2准备编译环境和数据目录")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("yum groupinstall "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Development tools"')]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y bison flex readline-devel zlib-devel\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /pgdata/10/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("data,backups,scripts,archvie_wals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R postgres.postgres /pgdata/10\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" 0700 /pgdata/10/data\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"_1-2-3解压安装包-编译安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3解压安装包-编译安装"}},[s._v("#")]),s._v(" 1.2.3解压安装包，编译安装")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost soft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxvf postgresql-10.20.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost soft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd postgresql-10.20")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost postgresql-10.20"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./configure --prefix=/opt/pg10/ --with-pgport=54321")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("执行gmake ,gmake install")]),s._v(" "),t("p",[s._v("gmake　　#出现successfully成功\ngmake install　　#PostgreSQL installation complete.安装成功")]),s._v(" "),t("p",[s._v("查看安装版本")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@localhost postgresql-10.20]# /opt/pg10/bin/postgres --version\npostgres (PostgreSQL) 10.20\n[root@localhost postgresql-10.20]# \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"_1-2-4设置-opt-pgsql的软连接指向当前版本-当变更版本的时候修改软连接即可"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4设置-opt-pgsql的软连接指向当前版本-当变更版本的时候修改软连接即可"}},[s._v("#")]),s._v(" 1.2.4设置/opt/pgsql的软连接指向当前版本，当变更版本的时候修改软连接即可")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /opt/pg10/ /opt/pgsql\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" 01:48 pg10\nlrwxrwxrwx. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" 01:49 pgsql -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/pg10/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"_1-2-5创建用户组和用户命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-5创建用户组和用户命令"}},[s._v("#")]),s._v(" 1.2.5创建用户组和用户命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# groupadd -g 1001 postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd -g 1001 -u 1001 postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_1-2-6切换为postgres用户-初始化数据库目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-6切换为postgres用户-初始化数据库目录"}},[s._v("#")]),s._v(" 1.2.6切换为postgres用户，初始化数据库目录")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("-bash-4.2$ /opt/pgsql/bin/initdb -D /pgdata/10/data/ -W\nThe files belonging to this database system will be owned by user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nThis user must also own the server process.\n\nThe database cluster will be initialized with locale "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"en_US.UTF-8"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nThe default database encoding has accordingly been "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF8"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nThe default text search configuration will be "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"english"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\nData page checksums are disabled.\n\nEnter new superuser password: \nEnter it again: \n\nfixing permissions on existing directory /pgdata/10/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\ncreating subdirectories "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nselecting default max_connections "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nselecting default shared_buffers "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". 128MB\nselecting default timezone "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". America/New_York\nselecting dynamic shared memory implementation "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". posix\ncreating configuration files "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nrunning bootstrap script "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nperforming post-bootstrap initialization "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nsyncing data to disk "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\n\nWARNING: enabling "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"trust"')]),s._v(" authentication "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" connections\nYou can change this by editing pg_hba.conf or using the option -A, or\n--auth-local and --auth-host, the next "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" you run initdb.\n\nSuccess. You can now start the database server using:\n\n    /opt/pgsql/bin/pg_ctl -D /pgdata/10/data/ -l logfile start\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br")])]),t("p",[s._v("到此，pg的编译安装部署完毕。")]),s._v(" "),t("p",[s._v("连接到刚安装好的数据库：")]),s._v(" "),t("p",[t("strong",[s._v("psql -p 端口 -h IP地址 -U 用户名称")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("-bash-4.2$ psql -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54321")]),s._v(" -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 -U postgres\npsql "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.21")]),s._v(", server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nType "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help.\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("postgres")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);