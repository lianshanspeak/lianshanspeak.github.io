(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{399:function(e,s,t){e.exports=t.p+"assets/img/864900-20211013215501321-836278154.8d47e7c4.png"},974:function(e,s,t){"use strict";t.r(s);var a=t(6),n=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"通过配置-psqlrc文件-定制日常维护脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过配置-psqlrc文件-定制日常维护脚本"}},[e._v("#")]),e._v(" 通过配置.psqlrc文件,定制日常维护脚本")]),e._v(" "),s("p",[e._v("编辑cat ~/.psqlrc文件")]),e._v(" "),s("p",[e._v("添加脚本")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[postgres@localhost ~]$ cat ~/.psqlrc\n\\set active_session ' select pid,usename,datname,query,client_addr from pg_stat_activity where pid <> pg_backend_pid() and state=\\'active\\' order by query;'\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("使用方法：冒号后面接变量名")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("postgres=# :active_session\n pid | usename | datname | query | client_addr\n-----+---------+---------+-------+-------------\n(0 rows)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("查询等待事件脚本")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[postgres@localhost ~]$ cat ~/.psqlrc\n\\set active_session ' select pid,usename,datname,query,client_addr from pg_stat_activity where pid <> pg_backend_pid() and state=\\'active\\' order by query;'\n\\set wait_event 'select pid,usename,datname,query,client_addr,wait_event_type,wait_event_type from pg_stat_activity where pid <> pg_backend_pid() and wait_event_type is not null order by wait_event_type;'\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[s("img",{attrs:{src:t(399),alt:"img"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);